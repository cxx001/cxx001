<!DOCTYPE HTML>
<html lang="zh-CN">

<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Hexo">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.0.0">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://cxx001.gitee.io">
    <!--SEO-->

<meta name="keywords" content="cmake,CMakeLists.txt" />


<meta name="description" content="CMake是什么CMake是一种跨平台的自动化构建工具，可以生成跨平台的构建文件。比如Makefile、Visual Studio、XCode解决方案。使用CMake可以使得编译和构建过程更加简..." />


<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->

<title>
    
    CMake进阶 |
    
    Hexo
</title>

<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    


<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7.css">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash.css">

    
<div class="hide">
    <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script>
</div>




    

<meta name="generator" content="Hexo 6.2.0"></head>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header"  style="background-image:url(
    https://hexo-theme-snippet-1251680922.cos.ap-beijing.myqcloud.com/img/banner.jpg)"
     >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='John Doe'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            <!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
            <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="https://cxx001.gitee.io">
                        Hexo</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa "></i>
                                首页</a>
                        </li>
                        
                        <li role="presentation" class="text-center">
                            <a href="/archives/"><i class="fa "></i>
                                时间轴</a>
                        </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="CMake进阶">
            
            CMake进阶
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a class="category-link" href="/categories/notes/">notes</a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            <a class="tag-none-link" href="/tags/CMakeLists-txt/" rel="tag">CMakeLists.txt</a> <a class="tag-none-link" href="/tags/cmake/" rel="tag">cmake</a>
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2023/03/10</span>
    </span>
    
    <span class="fa-wrap">
        <i class="fa fa-eye"></i>
        <span id="busuanzi_value_page_pv"></span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="CMake是什么"><a href="#CMake是什么" class="headerlink" title="CMake是什么"></a>CMake是什么</h2><p>CMake是一种跨平台的自动化构建工具，可以生成跨平台的构建文件。比如Makefile、Visual Studio、XCode解决方案。使用CMake可以使得编译和构建过程更加简单。<br>CMake使用CMakeLists.txt文件描述项目的构建过程，通过一系列的命令来描述如何编译、链接和打包源代码。</p>
<h3 id="CMake的优点"><a href="#CMake的优点" class="headerlink" title="CMake的优点"></a>CMake的优点</h3><ul>
<li>跨平台支持:CMake可以在windows、linux、macos等操作系统使用，并且可以支持多种编译器和构建工具。</li>
<li>灵活的构建过程:CMake的构建过程非常灵活，可以自定义编译选项、链接库等。</li>
<li>可拓展性:CMake可以使用自定义的模块拓展功能，可以方便的添加新的构建规则和命令。</li>
<li>高效的构建:支持多线程构建，可以加快构建速度。</li>
</ul>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="设置变量"><a href="#设置变量" class="headerlink" title="设置变量"></a>设置变量</h3><p>可以使用set命令设置变量参数,变量可以包含字符串和列表，命令是不区分大小写的</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置变量project为test</span></span><br><span class="line"><span class="keyword">set</span>(<span class="keyword">project</span> <span class="string">&quot;test&quot;</span>)</span><br><span class="line"><span class="comment"># 设置projects位列表</span></span><br><span class="line"><span class="keyword">set</span>(projects test1 test2)</span><br></pre></td></tr></table></figure>
<h3 id="引用变量"><a href="#引用变量" class="headerlink" title="引用变量"></a>引用变量</h3><p>使用${<VAR>}的方式引用定义的变量内容</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面语句输出test</span></span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="variable">$&#123;project&#125;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h3><p>cmake中的条件语句可以使用if、elseif、endif</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面代码根据CMAKE_SYSTEM_NAME判断不同的平台环境</span></span><br><span class="line"><span class="keyword">if</span>(CMAKE_SYSTEM_NAME <span class="keyword">STREQUAL</span> <span class="string">&quot;Windows&quot;</span>)</span><br><span class="line">  <span class="comment"># do something for Windows</span></span><br><span class="line"><span class="keyword">elseif</span>(CMAKE_SYSTEM_NAME <span class="keyword">STREQUAL</span> <span class="string">&quot;Darwin&quot;</span>)</span><br><span class="line">  <span class="comment"># do something for macOS</span></span><br><span class="line"><span class="keyword">elseif</span>(CMAKE_SYSTEM_NAME <span class="keyword">STREQUAL</span> <span class="string">&quot;Linux&quot;</span>)</span><br><span class="line">  <span class="comment"># do something for Linux</span></span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">  <span class="keyword">message</span>(FATAL_ERROR <span class="string">&quot;Unsupported system: $&#123;CMAKE_SYSTEM_NAME&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><p>cmake中循环语句包含while，foreach&#x2F;endforeach</p>
<h3 id="函数和宏定义"><a href="#函数和宏定义" class="headerlink" title="函数和宏定义"></a>函数和宏定义</h3><p>cmake中使用function来定义函数，使用macro来定义宏。<br>函数和宏都可以用来封装一些操作或者功能，并且在需要的时候调用他们。存在以下区别:  </p>
<ul>
<li>参数传递方式不同：函数的参数是以变量的形式传递的，而宏的参数则是以文本替换的方式传递的。</li>
<li>变量作用域不同：函数中定义的变量只能在函数内部使用，而宏中定义的变量则可以在宏的调用位置和宏内部使用。</li>
<li><strong>函数返回值类型只能为字符串</strong>：在CMake中，函数的返回值只能是字符串类型，而宏没有返回值。</li>
<li>函数可以使用return命令返回值：函数中可以使用return命令来返回一个字符串值，而宏没有此功能。</li>
<li>宏可以在其调用位置使用命令：宏可以在其调用位置执行一些命令，而函数则不能。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(func)</span><br><span class="line"></span><br><span class="line"><span class="keyword">endfunction</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">macro</span>(func2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmacro</span>()</span><br></pre></td></tr></table></figure>

<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>在cmake中行注释以 <code>#</code> 字符开始，直到行结束 。<br>块注释以 <code>#[[</code> 开始 , 以 <code>#]] </code>结束。</p>
<h2 id="常用内置变量"><a href="#常用内置变量" class="headerlink" title="常用内置变量"></a>常用内置变量</h2><h3 id="CMAKE-SOURCE-DIR"><a href="#CMAKE-SOURCE-DIR" class="headerlink" title="CMAKE_SOURCE_DIR"></a>CMAKE_SOURCE_DIR</h3><p>项目源码根目录的绝对路径。</p>
<h3 id="CMAKE-BINARY-DIR"><a href="#CMAKE-BINARY-DIR" class="headerlink" title="CMAKE_BINARY_DIR"></a>CMAKE_BINARY_DIR</h3><p>CMake生成的Makefile和可执行文件等二进制文件所在目录的绝对路径。</p>
<h3 id="CMAKE-CURRENT-SOURCE-DIR"><a href="#CMAKE-CURRENT-SOURCE-DIR" class="headerlink" title="CMAKE_CURRENT_SOURCE_DIR"></a>CMAKE_CURRENT_SOURCE_DIR</h3><p>当前处理的CMakeLists.txt所在的目录的绝对路径。</p>
<h3 id="CMAKE-CURRENT-BINARY-DIR"><a href="#CMAKE-CURRENT-BINARY-DIR" class="headerlink" title="CMAKE_CURRENT_BINARY_DIR"></a>CMAKE_CURRENT_BINARY_DIR</h3><p>当前处理的CMakeLists.txt生成的目标文件所在的目录的绝对路径。</p>
<h3 id="CMAKE-INSTALL-PREFIX"><a href="#CMAKE-INSTALL-PREFIX" class="headerlink" title="CMAKE_INSTALL_PREFIX"></a>CMAKE_INSTALL_PREFIX</h3><p>安装目录的根目录。</p>
<h3 id="CMAKE-CXX-COMPILER"><a href="#CMAKE-CXX-COMPILER" class="headerlink" title="CMAKE_CXX_COMPILER"></a>CMAKE_CXX_COMPILER</h3><p>C++编译器的完整路径。</p>
<h3 id="CMAKE-C-COMPILER"><a href="#CMAKE-C-COMPILER" class="headerlink" title="CMAKE_C_COMPILER"></a>CMAKE_C_COMPILER</h3><p>C编译器的完整路径。</p>
<h3 id="CMAKE-BUILD-TYPE"><a href="#CMAKE-BUILD-TYPE" class="headerlink" title="CMAKE_BUILD_TYPE"></a>CMAKE_BUILD_TYPE</h3><p>构建类型，通常为Debug或Release。</p>
<h3 id="CMAKE-LIBRARY-OUTPUT-DIRECTORY"><a href="#CMAKE-LIBRARY-OUTPUT-DIRECTORY" class="headerlink" title="CMAKE_LIBRARY_OUTPUT_DIRECTORY"></a>CMAKE_LIBRARY_OUTPUT_DIRECTORY</h3><p>生成的动态库库文件输出目录。</p>
<h3 id="CMAKE-RUNTIME-OUTPUT-DIRECTORY"><a href="#CMAKE-RUNTIME-OUTPUT-DIRECTORY" class="headerlink" title="CMAKE_RUNTIME_OUTPUT_DIRECTORY"></a>CMAKE_RUNTIME_OUTPUT_DIRECTORY</h3><p>生成的可执行文件输出目录。</p>
<h3 id="CMAKE-ARCHIVE-OUTPUT-DIRECTORY"><a href="#CMAKE-ARCHIVE-OUTPUT-DIRECTORY" class="headerlink" title="CMAKE_ARCHIVE_OUTPUT_DIRECTORY"></a>CMAKE_ARCHIVE_OUTPUT_DIRECTORY</h3><p>生成的静态链接库文件的输出目录</p>
<h3 id="CMAKE-MODULE-PATH"><a href="#CMAKE-MODULE-PATH" class="headerlink" title="CMAKE_MODULE_PATH"></a>CMAKE_MODULE_PATH</h3><p>指定一组目录列表，用于cmake在构建过程中去查找模块或者脚本，这些模块或者脚本可以提供一些常用的功能，用于拓展cmake的功能。</p>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="add-executable"><a href="#add-executable" class="headerlink" title="add_executable"></a>add_executable</h3><p>add_executable用来生成一个可执行文件的目标</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(target_name source_file1 [source_file2 ...])</span><br></pre></td></tr></table></figure>
<p>其中，target_name是要生成的可执行文件的名称，source_file1、source_file2等是用于生成该可执行文件的源文件。<br>例如，如果我们有两个源文件main.cpp和helper.cpp，并且希望生成一个名为my_program的可执行文件，则可以在CMakeLists.txt文件中使用如下命令：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_executable</span>(my_program main.cpp helper.cpp)</span><br></pre></td></tr></table></figure>

<h3 id="add-library"><a href="#add-library" class="headerlink" title="add_library"></a>add_library</h3><p>add_library命令用来创建一个链接库目标。语法格式如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(target_name [STATIC | SHARED | MODULE] source1 [source2 ...])</span><br></pre></td></tr></table></figure>
<p>target_name为要创建的目标的名称。STATIC表示生成静态链接库，SHARED参数表示生成动态链接库，MODULE表示动态加载模块</p>
<p>在C++开发中，我们一般需要告诉编辑器头文件和库文件的搜索路径(1. C&#x2F;C++-&gt;附加包含目录 2. 链接器-&gt;常规-&gt;附加库目录和输入-&gt;附加依赖项)。对应cmake中就是下面这两个命令：<code>[target_]</code>include_directories，<code>[target_]</code>link_directories，<strong>注意带target_前缀的添加搜索路径只是针对当前目标库添加，而不带的是全局添加，后面所有库都会附加。</strong></p>
<h3 id="include-directories"><a href="#include-directories" class="headerlink" title="include_directories"></a>include_directories</h3><p>include_directories用于向编译器添加一个或多个头文件搜索路径。该命令将指定的路径添加到编译器的搜索路径中，以便编译器可以找到指定路径中的头文件。命令语法如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include_directories</span>([AFTER|BEFORE] [SYSTEM] dir1 [dir2 ...])</span><br></pre></td></tr></table></figure>

<h3 id="link-directories"><a href="#link-directories" class="headerlink" title="link_directories"></a>link_directories</h3><p>link_directories用于向链接器添加一个或多个库文件搜索路径。该命令将指定的路径添加到链接器的搜索路径中，以便链接器可以找到指定路径中的库文件</p>
<h3 id="add-definitions"><a href="#add-definitions" class="headerlink" title="add_definitions"></a>add_definitions</h3><p>add_definitions用于向编译器添加定义，它可以将一个或者多个定义添加到所有源文件的编译器命令中，影响编译器的行为。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_definitions</span>(-DFOO -DBAR ...)</span><br></pre></td></tr></table></figure>
<p>需要注意的是上面三个命令会影响所有的构建项目，包括子项目。如果想要只影响指定的项目，使用target前缀相关的命令。</p>
<h3 id="target-include-directories"><a href="#target-include-directories" class="headerlink" title="target_include_directories"></a>target_include_directories</h3><p>target_include_directories用于为一个目标添加头文件的搜索路径，可以添加一个或者多个目录，从而使编译器能找到头文件。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_include_directories</span>(&lt;<span class="keyword">target</span>&gt; [SYSTEM] [AFTER|BEFORE]</span><br><span class="line">   &lt;INTERFACE|PUBLIC|PRIVATE&gt; [items1...]</span><br><span class="line">   [&lt;INTERFACE|PUBLIC|PRIVATE&gt; [items2...] ...])</span><br></pre></td></tr></table></figure>

<h3 id="target-link-libraries"><a href="#target-link-libraries" class="headerlink" title="target_link_libraries"></a>target_link_libraries</h3><p>target_link_libraries用于为一个目标文件添加链接库。它可以向一个目标文件的链接器命令添加一个或者多个链接库。从而使编译器能够正确的链接到指定库。语法如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_link_libraries</span>(&lt;<span class="keyword">target</span>&gt;</span><br><span class="line">    &lt;PRIVATE|PUBLIC|INTERFACE&gt; item1 item2 ...</span><br><span class="line">    [LINK_PRIVATE|LINK_PUBLIC|LINK_INTERFACE]</span><br><span class="line">    [LINK_OPTIONS|INTERFACE_LINK_OPTIONS options...]</span><br><span class="line">    [<span class="keyword">LINK_LIBRARIES</span>|INTERFACE_LINK_LIBRARIES item1 item2 ...]</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="target-compile-definitions"><a href="#target-compile-definitions" class="headerlink" title="target_compile_definitions"></a>target_compile_definitions</h3><p>target_compile_definitions用于为一个指定目标文件添加编译器定义。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_compile_definitions</span>(&lt;<span class="keyword">target</span>&gt;</span><br><span class="line">   &lt;INTERFACE|PUBLIC|PRIVATE&gt; [items1...]</span><br><span class="line">   [&lt;INTERFACE|PUBLIC|PRIVATE&gt; [items2...] ...])</span><br><span class="line">   </span><br><span class="line"><span class="keyword">target_compile_definitions</span>(foo PUBLIC -DWIN32)</span><br><span class="line"><span class="keyword">target_compile_definitions</span>(foo PUBLIC -DFOO=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>以上三个target相关的命令都包含了PRIVATE、PUBLIC、INTERFACE三个不同的访问控制级别。相关含义如下:</p>
<ul>
<li>PRIVATE 表示为当前target设置的头文件路径、链接库和定义只对当前target可见(不具有传染性)。</li>
<li>PUBLIC 表示为当前target设置的相关属性可以被其他引用了该target的其他目标文件可见(具有传染性)。</li>
</ul>
<h3 id="include"><a href="#include" class="headerlink" title="include"></a>include</h3><p>用于在CMAKE_MODULE_PATH中加载指定的脚本或者模块文件，语法如下</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(filename)</span><br></pre></td></tr></table></figure>
<p>cmake文件引入成功之后就可以使用文件中定义的函数、变量、宏等</p>
<h3 id="find-package"><a href="#find-package" class="headerlink" title="find_package"></a>find_package</h3><p>用于在系统中查找已安装的库，并将其导入到CMake项目中。它通常用于在项目中引入第三方库。<br>find_package的语法如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(&lt;package_name&gt; [version] [EXACT] [QUIET] [MODULE] [REQUIRED] [COMPONENTS   ...])</span><br></pre></td></tr></table></figure>
<p>其中，<package_name>是要查找的库的名称，version指定了所需的版本，EXACT表示查找确切版本，QUIET表示不向用户输出查找过程，MODULE表示只查找CMake模块，REQUIRED表示库是必需的，如果找不到则会出现错误。find_package还可以指定库的组件,通过COMPONENTS选项指定。比如Qt库中就包含组件Core、Gui等。可以按照项目实际需求指定库的组件。<br><strong>当find_package找到库时，会在CMAKE变量中设置一些有用的变量</strong>。比如</p>
<ul>
<li><package_name>_FOUND：表示库是否已经找到。</li>
<li><package_name>_INCLUDE_DIRS：表示库头文件所在目录的列表。</li>
<li><package_name>_LIBRARIES：表示包含的链接库列表<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(Boost <span class="number">1.72</span>.<span class="number">0</span> REQUIRED COMPONENTS filesystem system)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(Boost_FOUND)</span><br><span class="line">    <span class="keyword">include_directories</span>(<span class="variable">$&#123;Boost_INCLUDE_DIRS&#125;</span>)</span><br><span class="line">    <span class="keyword">add_executable</span>(myapp main.cpp)</span><br><span class="line">    <span class="keyword">target_link_libraries</span>(myapp <span class="variable">$&#123;Boost_LIBRARIES&#125;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>
find_package有两种搜索模式：</li>
<li>模块模式(Module mode)<br>在该模式下，cmake会搜索一个名为Find<package_name>.cmake的文件。<strong>搜索路径的顺序依次是CMAKE_MODULE_PATH指定的目录、cmake安装目录中查找</strong>。如果找到了相应的文件，那么就会读取并处理该文件。</li>
<li>配置模式(Config mode)<br>该模式下，CMake会搜索<lowercasePackageName>-config.cmake文件或<PackageName>Config.cmake文件，我很少用。</li>
</ul>
<h2 id="帮助文档与示例"><a href="#帮助文档与示例" class="headerlink" title="帮助文档与示例"></a>帮助文档与示例</h2><p>上面只是介绍了一些cmake常用、基本的操作。还有很多特性、命令我们都可以通过cmd下<code>cmake --help</code>去查询了解。</p>
<p>最后是一个正式项目的示例：这是一个windows平台的QT项目，通过vscode使用cmake + ninja + msvc构建、编译。</p>
<blockquote>
<p>注：ninja与msvc(window平台编译器)关系类似make与gcc，前者是项目构建工具，后者是源码编译器。可以简单这么理解这个流程，cmake通过解析CMakeLists.txt构建工程，而解析操作则是由ninja完成的，最终编译代码则是用msvc完成。</p>
<p>ninja是谷歌的一个高效的构建工具，一般比vsstudio的快不少。</p>
</blockquote>
<p>vscode环境搭建步骤：</p>
<ol>
<li><p>安装QT4.8.7、vs2010、cmake(3.24.1)、vscode的cmake插件。</p>
</li>
<li><p>配置示例工程根目录的ninja到环境变量。</p>
</li>
<li><p><code>Ctrl+Shift+p</code>依次执行命令：</p>
<p>a. CMake:Configure，只需要执行一次，第一次会提示选择编译器(VisualStudio.10.0-x86)。</p>
<p>b. Cmake:Build，如果修改了代码重新Build不生效，可以先CMake:Clean，再CMake:Build。</p>
<p>c. 编译完就可以F5调试运行了。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://github.com/cxx001/resources/raw/main/cmake_prj_demo.zip">示例下载</a></p>

    </div>
    
    <div class="post-footer">
        <div>
            
            转载声明：
            商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">cxx</a>
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    <a href="/2023/03/27/project/%E9%A3%9E%E8%A1%8C%E4%BB%BF%E7%9C%9F%E5%BC%95%E6%93%8E%E8%B0%83%E5%BA%A6%E6%B5%81%E7%A8%8B/" class="pre-post btn btn-default" title='飞行仿真引擎调度流程'>
        <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
        <span class="hidden-xs">
            飞行仿真引擎调度流程</span>
    </a>
    
    
    <a href="/2023/03/08/threejs/threejs%E7%89%A9%E7%90%86%E6%95%88%E6%9E%9C%E5%92%8C%E5%A3%B0%E9%9F%B3/" class="next-post btn btn-default" title='threejs物理效果和声音'>
        <span class="hidden-lg">下一篇</span>
        <span class="hidden-xs">
            threejs物理效果和声音</span><i class="fa fa-angle-right fa-fw"></i>
    </a>
    
</div>

<div id="comments">
    
    
<div class="utteranc">
  
  <script
    src='https://utteranc.es/client.js'
    repo='cxx001/myblog-comment'
    issue-term='pathname'
    issue-number=''
    theme='github-light'
    label=''
    crossorigin='anonymous'
    async
  ></script>
</div>



</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            文章目录
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CMake%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">CMake是什么</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CMake%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-text">CMake的优点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-text">语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8F%98%E9%87%8F"><span class="toc-text">设置变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E5%8F%98%E9%87%8F"><span class="toc-text">引用变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="toc-text">条件语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="toc-text">循环语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%92%8C%E5%AE%8F%E5%AE%9A%E4%B9%89"><span class="toc-text">函数和宏定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-text">注释</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F"><span class="toc-text">常用内置变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-SOURCE-DIR"><span class="toc-text">CMAKE_SOURCE_DIR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-BINARY-DIR"><span class="toc-text">CMAKE_BINARY_DIR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-CURRENT-SOURCE-DIR"><span class="toc-text">CMAKE_CURRENT_SOURCE_DIR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-CURRENT-BINARY-DIR"><span class="toc-text">CMAKE_CURRENT_BINARY_DIR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-INSTALL-PREFIX"><span class="toc-text">CMAKE_INSTALL_PREFIX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-CXX-COMPILER"><span class="toc-text">CMAKE_CXX_COMPILER</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-C-COMPILER"><span class="toc-text">CMAKE_C_COMPILER</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-BUILD-TYPE"><span class="toc-text">CMAKE_BUILD_TYPE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-LIBRARY-OUTPUT-DIRECTORY"><span class="toc-text">CMAKE_LIBRARY_OUTPUT_DIRECTORY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-RUNTIME-OUTPUT-DIRECTORY"><span class="toc-text">CMAKE_RUNTIME_OUTPUT_DIRECTORY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-ARCHIVE-OUTPUT-DIRECTORY"><span class="toc-text">CMAKE_ARCHIVE_OUTPUT_DIRECTORY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMAKE-MODULE-PATH"><span class="toc-text">CMAKE_MODULE_PATH</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#add-executable"><span class="toc-text">add_executable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#add-library"><span class="toc-text">add_library</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#include-directories"><span class="toc-text">include_directories</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#link-directories"><span class="toc-text">link_directories</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#add-definitions"><span class="toc-text">add_definitions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#target-include-directories"><span class="toc-text">target_include_directories</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#target-link-libraries"><span class="toc-text">target_link_libraries</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#target-compile-definitions"><span class="toc-text">target_compile_definitions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#include"><span class="toc-text">include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#find-package"><span class="toc-text">find_package</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3%E4%B8%8E%E7%A4%BA%E4%BE%8B"><span class="toc-text">帮助文档与示例</span></a></li></ol>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
    访问量:
    <strong id="busuanzi_value_site_pv">
        <i class="fa fa-spinner fa-spin"></i>
    </strong>
    &nbsp; | &nbsp;
    访客数:
    <strong id="busuanzi_value_site_uv">
        <i class="fa fa-spinner fa-spin"></i>
    </strong>
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2022
                    
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<script src="/js/app.js?rev=@@hash.js"></script>

</body>
</html>